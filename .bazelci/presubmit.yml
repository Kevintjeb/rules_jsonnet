---
matrix:
  platform:
  - ubuntu2204
  - macos
  toolchain:
  - "@rules_jsonnet//jsonnet:go_jsonnet_toolchain"
  - "@rules_jsonnet//jsonnet:cpp_jsonnet_toolchain"
  - "@rules_jsonnet//jsonnet:rust_jsonnet_toolchain"

tasks:
  rules_jsonnet:
    name: rules_jsonnet
    platform: ${{ platform }}
    build_targets:
    - //...

  docs:
    name: docs
    platform: ${{ platform }}
    working_directory: docs
    test_flags:
    - "--extra_toolchains=${{ toolchain }}"
    test_targets:
    - //...

  examples:
    name: examples
    platform: ${{ platform }}
    working_directory: examples
    test_flags:
    - "--extra_toolchains=${{ toolchain }}"
    test_targets:
    - //...
